<!doctype html>
<html>
<head>
    <script>
        async function getData() {
            const response = await fetch('https://salesforcecommercecloud.github.io/b2c-dev-doc/search.json');
            const data = await response.json();
            return data;
        }

        var data = getData();
        var ret;
        data.then(result => ret = result)

        function formatPage(page, val) {
            let html = '<div id="resultBlock"><a href="https://salesforcecommercecloud.github.io' + page.url + '" target="_blank">'+page.title+'</a>'+
                '<br><p>' + page?.content?.substring(0,250) + '...</p><br></div><br>'
            let bval = '<b>' + val + '</b>'
            return html.replaceAll(val,bval);
        }

        function searchList() {
            var val = document.getElementById('searchTerm').value.toUpperCase();
            var results = 
                ret.filter(page => Object.keys(page).length &&
                    (page.content?.toUpperCase().indexOf(val) !== -1 || page.title?.toUpperCase().indexOf(val) !== -1) && 
                    page.url?.indexOf('/upcoming/') !== -1 && 
                    page.title?.indexOf('Server-side javascript') === -1)
                .map(page => formatPage(page, val)).join('');
            document.getElementById('searchResult').innerHTML = results;
        }
    </script>
    <style>
        .center {
            margin-top: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <div class="center">
        <input type="text" id="searchTerm" />
        <button onClick="searchList()">Search</button>
    </div>
    <div id="searchResult">

    </div>
</body>
</html>
